# ğŸ† SolarPilot - æ¯”èµ›å¼€å‘ Backlog

## ğŸ¯ å¼€å‘ç›®æ ‡
**èµ¢æ¯”èµ›** - å±•ç¤ºå®Œæ•´çš„å…‰å‚¨è°ƒåº¦ç³»ç»Ÿèƒ½åŠ›ï¼Œæä¾›æ¸…æ™°çš„è¯æ®é“¾ç»™è¯„å§”

---

## ğŸ“Š P0 - å¿…é¡»å®Œæˆï¼ˆèµ¢æ¯”èµ›çš„æ ¸å¿ƒï¼‰

### ğŸ” Issue #1: Validation é¡µé¢ - å›æµ‹æŒ‡æ ‡å±•ç¤º
**ç›®æ ‡**: è¯æ˜é¢„æµ‹æ¨¡å‹çš„å‡†ç¡®æ€§å’Œå¯é æ€§

**åŠŸèƒ½éœ€æ±‚**:
- [ ] 1.1 å±•ç¤ºå›æµ‹æŒ‡æ ‡
  - NRMSE (Normalized Root Mean Square Error)
  - MAE (Mean Absolute Error)  
  - MAPE (Mean Absolute Percentage Error)
  - æ—¶é—´åºåˆ—å¯¹æ¯”å›¾ï¼ˆé¢„æµ‹ vs å®é™…ï¼‰

- [ ] 1.2 æ¦‚ç‡é¢„æµ‹è¦†ç›–ç‡
  - P10/P50/P90 é¢„æµ‹åŒºé—´å¯è§†åŒ–
  - Coverage P10-P90 (çœŸå®å€¼è½åœ¨åŒºé—´å†…çš„ç™¾åˆ†æ¯”)
  - Sharpness (åŒºé—´å®½åº¦ = P90 - P10)
  - ç½®ä¿¡åŒºé—´å›¾è¡¨

- [ ] 1.3 åˆ†æ—¶æ®µæ€§èƒ½åˆ†æ
  - æŒ‰å°æ—¶/å¤©/æœˆç»Ÿè®¡æŒ‡æ ‡
  - å¤©æ°”æ¡ä»¶åˆ†ç»„ï¼ˆæ™´/é˜´/é›¨ï¼‰

**API éœ€æ±‚**:
```python
GET /api/validation/{site_id}
Response: {
  "metrics": {
    "nrmse": 0.12,
    "mae": 45.3,
    "mape": 8.5,
    "coverage_10_90": 0.89,  # 89%çš„ç‚¹è½åœ¨P10-P90åŒºé—´
    "sharpness": 234.5  # kW
  },
  "timeseries": [...],
  "hourly_stats": [...]
}
```

**å‰ç«¯é¡µé¢**: `validation_page.dart`

---

### ğŸ“ˆ Issue #2: Impact é¡µé¢ - Baseline vs Optimized å¯¹æ¯”
**ç›®æ ‡**: é‡åŒ–å±•ç¤ºä¼˜åŒ–æ•ˆæœçš„ç»æµä»·å€¼

**åŠŸèƒ½éœ€æ±‚**:
- [ ] 2.1 æˆæœ¬å¯¹æ¯”
  - Baseline æˆæœ¬ï¼ˆä¸è°ƒåº¦ï¼‰
  - Optimized æˆæœ¬ï¼ˆä¼˜åŒ–è°ƒåº¦ï¼‰
  - èŠ‚çœé‡‘é¢ + ç™¾åˆ†æ¯”
  - æ¯æ—¥/æ¯æœˆè¶‹åŠ¿å›¾

- [ ] 2.2 å³°å€¼å‰Šå‡
  - Baseline å³°å€¼åŠŸç‡
  - Optimized å³°å€¼åŠŸç‡
  - å‰Šå³°ç™¾åˆ†æ¯”
  - éœ€é‡è´¹èŠ‚çœ

- [ ] 2.3 å¼ƒå…‰å‡å°‘
  - Baseline å¼ƒå…‰é‡
  - Optimized å¼ƒå…‰é‡
  - å‡å°‘ç™¾åˆ†æ¯”
  - æ—¶é—´åˆ†å¸ƒå›¾

- [ ] 2.4 ç”µæ± å¾ªç¯ä¼˜åŒ–
  - Baseline ç­‰æ•ˆå…¨å¾ªç¯æ¬¡æ•° (EFC)
  - Optimized EFC
  - ç”µæ± å¯¿å‘½å»¶é•¿ä¼°ç®—

**API éœ€æ±‚**:
```python
GET /api/impact/{site_id}?start_date=xxx&end_date=xxx
Response: {
  "cost": {
    "baseline": 2450.20,
    "optimized": 1850.75,
    "saving": 599.45,
    "saving_pct": 24.5
  },
  "peak": {
    "baseline_kw": 6800,
    "optimized_kw": 5100,
    "reduction_kw": 1700,
    "reduction_pct": 25.0
  },
  "curtailment": {
    "baseline_kwh": 45.2,
    "optimized_kwh": 15.5,
    "reduction_kwh": 29.7,
    "reduction_pct": 65.7
  },
  "battery_cycles": {
    "baseline_efc": 2.3,
    "optimized_efc": 1.8,
    "life_extension_days": 45
  }
}
```

**å‰ç«¯é¡µé¢**: `impact_page.dart`

---

### ğŸ“‹ Issue #3: Overview å¢å¼º - Today's Action Plan
**ç›®æ ‡**: å‘è¯„å§”å±•ç¤ºç³»ç»Ÿçš„å®æ—¶å†³ç­–èƒ½åŠ›

**åŠŸèƒ½éœ€æ±‚**:
- [ ] 3.1 ä»Šæ—¥è¡ŒåŠ¨è®¡åˆ’
  - å½“å‰æ—¶åˆ»å»ºè®®åŠ¨ä½œï¼ˆå……ç”µ/æ”¾ç”µ/å¾…æœºï¼‰
  - ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼ˆç”µä»·é«˜/é¢„æµ‹é˜´å¤©/å³°å€¼æ—¶æ®µï¼‰
  - é¢„æœŸæ”¶ç›Š

- [ ] 3.2 é£é™©æç¤º
  - é¢„æµ‹ä¸ç¡®å®šæ€§ï¼ˆåŒºé—´å®½åº¦å¤§ï¼‰
  - å¤©æ°”çªå˜é£é™©ï¼ˆäº‘å±‚å¿«é€Ÿå˜åŒ–ï¼‰
  - ç”µæ± SOCè­¦å‘Šï¼ˆè¿‡é«˜/è¿‡ä½ï¼‰

- [ ] 3.3 å…³é”®å†³ç­–ç‚¹æ—¶é—´è½´
  - 0:00-6:00: è°·æ—¶å……ç”µï¼ˆç”µä»·0.3å…ƒ/kWhï¼‰
  - 10:00-14:00: å…‰ä¼å‡ºåŠ›é«˜å³°ï¼Œå‚¨èƒ½å¾…æœº
  - 18:00-21:00: æ™šé«˜å³°æ”¾ç”µï¼ˆç”µä»·1.2å…ƒ/kWhï¼Œå‰Šå³°ï¼‰

**API éœ€æ±‚**:
```python
GET /api/overview/{site_id}/action-plan
Response: {
  "current_action": {
    "mode": "charging",  # charging/discharging/idle
    "reason": "valley_price_period",
    "price": 0.3,
    "expected_saving": 245.5
  },
  "risks": [
    {
      "type": "forecast_uncertainty",
      "severity": "medium",
      "message": "é¢„æµ‹åŒºé—´è¾ƒå®½ï¼Œå»ºè®®ä¿å®ˆè°ƒåº¦"
    }
  ],
  "timeline": [
    {
      "time": "00:00-06:00",
      "action": "charge",
      "reason": "è°·æ—¶ç”µä»·0.3å…ƒ/kWh",
      "target_soc": 0.9
    },
    ...
  ]
}
```

**å‰ç«¯ä¿®æ”¹**: æ‰©å±• `overview_page.dart`

---

### âš¡ Issue #4: Risk-aware Dispatch - P10/P50/P90 ä¼˜åŒ–
**ç›®æ ‡**: è¯æ˜ç³»ç»Ÿèƒ½å¤„ç†é¢„æµ‹ä¸ç¡®å®šæ€§

**åŠŸèƒ½éœ€æ±‚**:
- [ ] 4.1 ä¸‰ç§é£é™©æ¨¡å¼
  - Conservative (P10): æ‚²è§‚é¢„æµ‹ï¼Œä¿å®ˆè°ƒåº¦
  - Balanced (P50): ä¸­ä½æ•°é¢„æµ‹ï¼Œå¹³è¡¡è°ƒåº¦
  - Aggressive (P90): ä¹è§‚é¢„æµ‹ï¼Œæ¿€è¿›è°ƒåº¦

- [ ] 4.2 æ¨¡å¼å¯¹æ¯”
  - ä¸‰ç§æ¨¡å¼çš„æˆæœ¬/æ”¶ç›Š
  - é£é™©æ”¶ç›Šæƒè¡¡å›¾
  - æ¨èæ¨¡å¼ï¼ˆåŸºäºå½“å‰ä¸ç¡®å®šæ€§ï¼‰

- [ ] 4.3 åŠ¨æ€åˆ‡æ¢
  - æ ¹æ®é¢„æµ‹ç½®ä¿¡åº¦è‡ªåŠ¨é€‰æ‹©æ¨¡å¼
  - ç”¨æˆ·æ‰‹åŠ¨åˆ‡æ¢
  - æ¨¡å¼åˆ‡æ¢å†å²è®°å½•

**API éœ€æ±‚**:
```python
POST /api/dispatch/{site_id}/optimize
Body: {
  "risk_mode": "p50",  # p10/p50/p90
  "horizon_hours": 24
}
Response: {
  "mode": "p50",
  "schedule": [...],
  "expected_cost": 1850.75,
  "confidence_interval": [1720, 1980],
  "risk_metrics": {
    "worst_case_cost": 2100,
    "best_case_cost": 1650
  }
}
```

**å‰ç«¯ä¿®æ”¹**: æ‰©å±• `dispatch_page.dart`ï¼Œå¢åŠ é£é™©æ¨¡å¼é€‰æ‹©å™¨

---

## ğŸ P1 - åŠ åˆ†é¡¹ï¼ˆå±•ç¤ºç³»ç»Ÿçµæ´»æ€§ï¼‰

### ğŸ”¬ Issue #5: Simulator - å‚æ•°è°ƒæ•´å®æ—¶ä»¿çœŸ
**ç›®æ ‡**: å±•ç¤ºç³»ç»Ÿå¯¹ä¸åŒåœºæ™¯çš„é€‚åº”èƒ½åŠ›

**åŠŸèƒ½éœ€æ±‚**:
- [ ] 5.1 å‚æ•°è°ƒæ•´ç•Œé¢
  - ç”µä»·æ›²çº¿ç¼–è¾‘å™¨ï¼ˆå³°è°·å¹³æ—¶æ®µ+ä»·æ ¼ï¼‰
  - éœ€é‡è´¹ç‡è°ƒæ•´ï¼ˆå…ƒ/kW/æœˆï¼‰
  - ç”µæ± è§„æ ¼ï¼ˆå®¹é‡kWh / åŠŸç‡kW / æ•ˆç‡ï¼‰
  - å¹¶ç½‘é™é¢ï¼ˆæœ€å¤§å‡ºåŠ›kWï¼‰

- [ ] 5.2 å®æ—¶ä»¿çœŸ
  - ç‚¹å‡»"Run Simulation"ç«‹å³è®¡ç®—
  - 3-5ç§’å†…è¿”å›ç»“æœ
  - å±•ç¤ºæ–°åœºæ™¯ä¸‹çš„ä¼˜åŒ–è°ƒåº¦

- [ ] 5.3 åœºæ™¯å¯¹æ¯”
  - å½“å‰åœºæ™¯ vs æ–°åœºæ™¯
  - å·®å¼‚é«˜äº®æ˜¾ç¤º
  - ä¿å­˜åœºæ™¯æ¨¡æ¿

**å‰ç«¯é¡µé¢**: `simulator_page.dart`

---

### ğŸ“Š Issue #6: Dispatch å¯è§£é‡Šæ€§
**ç›®æ ‡**: å‘è¯„å§”è§£é‡Šä¸ºä»€ä¹ˆè¿™ä¹ˆè°ƒåº¦

**åŠŸèƒ½éœ€æ±‚**:
- [ ] 6.1 çº¦æŸç»‘å®šåˆ†æ
  - å“ªäº›çº¦æŸåœ¨é™åˆ¶ä¼˜åŒ–ï¼ˆç”µæ± åŠŸç‡/SOC/å¹¶ç½‘ï¼‰
  - æ¾å¼›è¿™äº›çº¦æŸèƒ½è·å¾—å¤šå°‘æ”¶ç›Š

- [ ] 6.2 ç‚¹å‡»è§£é‡Š
  - ç‚¹å‡»æ—¶é—´ç‚¹æ˜¾ç¤ºï¼š
    - æ­¤æ—¶åˆ»çš„ç”µä»·
    - å…‰ä¼é¢„æµ‹å€¼
    - è´Ÿè·é¢„æµ‹å€¼
    - ç”µæ± åŠ¨ä½œåŸå› 

- [ ] 6.3 ç”µä»·èƒŒæ™¯å±‚
  - è°ƒåº¦æ›²çº¿èƒŒæ™¯ç”¨é¢œè‰²æ ‡æ³¨ç”µä»·
  - å³°è°·å¹³æ—¶æ®µå¯è§†åŒ–

**å‰ç«¯ä¿®æ”¹**: æ‰©å±• `dispatch_page.dart`ï¼Œå¢åŠ äº¤äº’åŠŸèƒ½

---

### ğŸ“„ Issue #7: Reports & Audit - æ—¥æŠ¥å’Œå®¡è®¡æ—¥å¿—
**ç›®æ ‡**: å±•ç¤ºç³»ç»Ÿçš„ä¸“ä¸šæ€§å’Œå¯è¿½æº¯æ€§

**åŠŸèƒ½éœ€æ±‚**:
- [ ] 7.1 æ—¥æŠ¥å¯¼å‡º
  - PDF/Excel æ ¼å¼
  - åŒ…å«æ‰€æœ‰å…³é”®æŒ‡æ ‡
  - å›¾è¡¨åµŒå…¥
  - è‡ªåŠ¨å‘é€é‚®ä»¶ï¼ˆå¯é€‰ï¼‰

- [ ] 7.2 å®¡è®¡æ—¥å¿—
  - è®°å½•æ‰€æœ‰å…³é”®æ“ä½œï¼ˆè°ƒåº¦å‚æ•°ä¿®æ”¹/æ¨¡å¼åˆ‡æ¢ï¼‰
  - æ—¶é—´æˆ³ + æ“ä½œäºº
  - å¯ç­›é€‰æŸ¥è¯¢

**å‰ç«¯é¡µé¢**: `reports_page.dart` + `audit_page.dart`

---

## ğŸŒŸ P2 - é”¦ä¸Šæ·»èŠ±ï¼ˆæå‡ä¸“ä¸šåº¦ï¼‰

### ğŸš¨ Issue #8: Alerts æ™ºèƒ½é—­ç¯
**ç›®æ ‡**: å±•ç¤ºç³»ç»Ÿçš„è‡ªåŠ¨åŒ–è¿ç»´èƒ½åŠ›

**åŠŸèƒ½éœ€æ±‚**:
- [ ] 8.1 æ¨èåŠ¨ä½œ
  - Alert æ˜¾ç¤ºæ—¶æä¾›è§£å†³æ–¹æ¡ˆ
  - "æ¨¡å‹åå·®å¤§" â†’ æ¨è"é‡æ–°æ ¡å‡†"
  - "ç”µæ± æ¸©åº¦é«˜" â†’ æ¨è"é™ä½åŠŸç‡"

- [ ] 8.2 ä¸€é”®è§¦å‘
  - ç‚¹å‡»æŒ‰é’®æ‰§è¡Œæ¨èåŠ¨ä½œ
  - åå°è‡ªåŠ¨è°ƒç”¨ API
  - æ˜¾ç¤ºæ‰§è¡Œç»“æœ

**å‰ç«¯ä¿®æ”¹**: æ‰©å±• `alerts_page.dart`

---

### ğŸ‘¥ Issue #9: RBAC è§’è‰²æƒé™
**åŠŸèƒ½éœ€æ±‚**:
- [ ] 9.1 è§’è‰²å®šä¹‰
  - Admin: å…¨éƒ¨æƒé™
  - Operator: æŸ¥çœ‹+è°ƒæ•´å‚æ•°
  - Viewer: åªè¯»

- [ ] 9.2 æƒé™æ§åˆ¶
  - æŒ‰é’®ç¦ç”¨/éšè—
  - API å±‚é¢éªŒè¯

---

### ğŸŒ Issue #10: å¤šç«™ç‚¹æ±‡æ€»
**åŠŸèƒ½éœ€æ±‚**:
- [ ] 10.1 æ±‡æ€»é¡µé¢
  - æ‰€æœ‰ç«™ç‚¹çš„æ€»æ”¶ç›Š
  - æ€»å¼ƒå…‰/æ€»å‰Šå³°
  - ç«™ç‚¹å¯¹æ¯”æ’å

---

## ğŸ“ ç»Ÿä¸€è¾“å‡ºæ ¼å¼ï¼ˆè¯æ®é“¾è§„èŒƒï¼‰

### åç«¯ API å¿…é¡»æä¾›çš„ 3 ç±»è¯æ®

#### 1ï¸âƒ£ Forecast è¯æ®
```json
{
  "metrics": {
    "nrmse": 0.12,           // å½’ä¸€åŒ–å‡æ–¹æ ¹è¯¯å·®
    "mae": 45.3,             // å¹³å‡ç»å¯¹è¯¯å·® (kW)
    "mape": 8.5,             // å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·® (%)
    "coverage_10_90": 0.89,  // P10-P90è¦†ç›–ç‡
    "sharpness": 234.5       // åŒºé—´å®½åº¦ (kW)
  },
  "timestamp": "2026-02-11T10:30:00Z"
}
```

#### 2ï¸âƒ£ Dispatch è¯æ®
```json
{
  "optimization_results": {
    "cost_saving": 599.45,           // å…ƒ
    "cost_saving_pct": 24.5,         // %
    "peak_reduction_kw": 1700,       // kW
    "peak_reduction_pct": 25.0,      // %
    "curtailment_reduction_kwh": 29.7, // kWh
    "curtailment_reduction_pct": 65.7, // %
    "battery_efc_reduction": 0.5     // ç­‰æ•ˆå…¨å¾ªç¯æ¬¡æ•°
  }
}
```

#### 3ï¸âƒ£ System è¯æ®
```json
{
  "performance": {
    "forecast_time_ms": 245,      // é¢„æµ‹è€—æ—¶
    "optimization_time_ms": 1850, // ä¼˜åŒ–è€—æ—¶
    "task_success_rate": 0.998,   // ä»»åŠ¡æˆåŠŸç‡
    "uptime_hours": 720           // ç³»ç»Ÿè¿è¡Œæ—¶é•¿
  }
}
```

---

## ğŸ¯ å¼€å‘ä¼˜å…ˆçº§å»ºè®®

### Sprint 1 (Week 1): P0 æ ¸å¿ƒ
1. Issue #1: Validation é¡µé¢ï¼ˆ2å¤©ï¼‰
2. Issue #2: Impact é¡µé¢ï¼ˆ2å¤©ï¼‰
3. Issue #3: Overview å¢å¼ºï¼ˆ1å¤©ï¼‰

### Sprint 2 (Week 2): P0 å®Œå–„ + P1 å¼€å§‹
4. Issue #4: Risk-aware dispatchï¼ˆ2å¤©ï¼‰
5. Issue #5: Simulatorï¼ˆ2å¤©ï¼‰
6. Issue #6: Dispatch å¯è§£é‡Šï¼ˆ1å¤©ï¼‰

### Sprint 3 (Week 3): P1/P2 æ”¶å°¾
7. Issue #7: Reports & Auditï¼ˆ2å¤©ï¼‰
8. Issue #8-10: P2 åŠŸèƒ½æŒ‰éœ€é€‰æ‹©ï¼ˆ3å¤©ï¼‰

---

## ğŸ“‹ GitHub Projects ç»“æ„å»ºè®®

### Board åˆ—
1. **Backlog** - å¾…è§„åˆ’
2. **To Do** - æœ¬å‘¨è®¡åˆ’
3. **In Progress** - å¼€å‘ä¸­
4. **Review** - å¾…å®¡æŸ¥
5. **Done** - å·²å®Œæˆ

### Labels
- `P0-must-have` ğŸ”´
- `P1-nice-to-have` ğŸŸ¡
- `P2-polish` ğŸŸ¢
- `frontend` ğŸ’»
- `backend` âš™ï¸
- `api` ğŸ”Œ
- `evidence` ğŸ“Š

---

## âœ… Definition of Done

æ¯ä¸ª Issue å®Œæˆæ—¶å¿…é¡»åŒ…å«ï¼š
1. âœ… å‰ç«¯é¡µé¢/ç»„ä»¶å®Œæˆ
2. âœ… Mock API æ•°æ®å‡†å¤‡å¥½
3. âœ… å•å…ƒæµ‹è¯•é€šè¿‡ï¼ˆå¯é€‰ï¼‰
4. âœ… åœ¨æ¼”ç¤ºç¯å¢ƒå¯è®¿é—®
5. âœ… æä¾›æˆªå›¾/å½•å±è¯æ®
6. âœ… æ›´æ–°æ–‡æ¡£

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨å‘½ä»¤

```bash
# æŸ¥çœ‹æ‰€æœ‰ Issue
gh issue list --label "P0-must-have"

# åˆ›å»ºæ–° Issue
gh issue create --title "å®ç° Validation é¡µé¢" --label "P0-must-have,frontend" --body "..."

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd apps/mobile_flutter
flutter run -d chrome
```

---

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**: 
1. åœ¨ GitHub åˆ›å»º Project Board
2. æŒ‰ç…§æ­¤ Backlog åˆ›å»º Issues
3. å¼€å§‹ Sprint 1 - Validation é¡µé¢å¼€å‘
